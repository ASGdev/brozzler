language: python
python:
- 3.4
sudo: required
dist: trusty
before_install:
- type -a python
- type -a python3
- env
- lsb_release -a
- echo $PATH
- id
- sudo id
- sudo initctl list-env
- sudo apt-add-repository -y ppa:ansible/ansible
- sudo apt-get -qq update
- sudo apt-get install -y ansible
install:
- type -a virtualenv
- virtualenv --version
- ansible-playbook -vvv --extra-vars="brozzler_pip_name=file://$TRAVIS_BUILD_DIR#egg=brozzler user=travis" --inventory-file=ansible/hosts-localhost ansible/playbook.yml
- pip install $TRAVIS_BUILD_DIR pytest
- type -a virtualenv
- virtualenv --version
- ls -l /opt /opt/*/bin /opt/*/lib/python3.4/site-packages
- cat /etc/init/warcprox.conf
- cat /etc/init/brozzler-worker.conf
- cat /etc/init/pywb.conf
- sudo cat /var/log/upstart/warcprox.log
- sudo cat /var/log/upstart/brozzler-worker.log
- sudo cat /var/log/upstart/pywb.log
- sudo initctl reload-configuration
- sudo service Xvnc restart
- sudo service vnc-websock restart
- sudo service brozzler-worker restart
- sudo service brozzler-dashboard restart
- sudo cat /var/log/upstart/warcprox.log
- sudo cat /var/log/upstart/brozzler-worker.log
- sudo cat /var/log/upstart/pywb.log
script:
- py.test -v -s tests
after_failure:
- ls -l /opt
- sudo cat /var/log/upstart/warcprox.log
- sudo cat /var/log/upstart/brozzler-worker.log
- sudo cat /var/log/upstart/pywb.log

